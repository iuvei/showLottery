<?php
 namespace Fuzhi\Model; use Think\Model; class FeedbackModel extends Model { protected $_validate = array( array('fed_type', 'require', '问题类型必须', self::MUST_VALIDATE, 'regex', self::MODEL_BOTH), array('fed_contact', 'require', '联系方式必须', self::MUST_VALIDATE, 'regex', self::MODEL_BOTH), array('fed_content', 'require', '问题内容必须', self::MUST_VALIDATE, 'regex', self::MODEL_BOTH), array('fed_type', '1,100', '问题类型不能超过100个字符', self::MUST_VALIDATE, 'length', self::MODEL_BOTH), array('fed_contact', '1,100', '联系方式不能超过100个字符', self::MUST_VALIDATE, 'length', self::MODEL_BOTH), ); protected $_auto = array( array('fed_created_time', 'time', self::MODEL_INSERT, 'function'), array('fed_status', 1), ); protected $_map = array( 'fbType' => 'fed_type', 'fbContact' => 'fed_contact', 'fbContent' => 'fed_content', ); public function update(){ $data = $this->create($_POST); if(empty($data)){ return false; } if(empty($data['id'])){ $id = $this->add(); if(!$id){ $this->error = '新增反馈出错！'; return false; } } else { $status = $this->save(); if(false === $status){ $this->error = '更新反馈出错！'; return false; } } S('action_list', null); return $data; } } 